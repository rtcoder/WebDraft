var file={upload:function(c){var b=c.target;var d;var e;var a=new Image();a.src=URL.createObjectURL(b.files[0]);a.onload=function(){d=this.width;e=this.height;layers.newLayer();layers.setLayerSize(layers.activeId,d,e);webDraft.func.positionElements();ctx.drawImage(a,0,0);layers.saveState();keys.O=false}},download:function(){$(webDraft.draw.selectorId).append('<canvas id="tmpCanvas" width="'+webDraft.draw.width+'" height="'+webDraft.draw.height+'"></canvas>');var b=document.getElementById("tmpCanvas");var c=b.getContext("2d");for(var a=0;a<=layers.list.id.length;a++){if(typeof layers.list.id[a]==="string"&&layers.list.visible[a]===true){var f=document.getElementById(layers.list.id[a]);var e=parseInt($("#"+layers.list.id[a]).css("top"));var d=parseInt($("#"+layers.list.id[a]).css("left"));c.drawImage(f,e,d)}}$("#tmpCanvas").width(webDraft.draw.width).height(webDraft.draw.height);b.toBlob(function(g){saveAs(g,"image.png")});$("#tmpCanvas").remove()}};